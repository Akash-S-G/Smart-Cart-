{"ast":null,"code":"import { create } from 'zustand';\nimport axios from 'axios';\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\nexport const useAuthStore = create(set => ({\n  user: null,\n  isAuthenticated: false,\n  token: localStorage.getItem('token'),\n  login: async (email, password) => {\n    try {\n      const response = await axios.post(`${API_URL}/auth/login`, {\n        email,\n        password\n      });\n      const {\n        access_token,\n        user\n      } = response.data;\n      localStorage.setItem('token', access_token);\n      set({\n        user: {\n          ...user,\n          role: user.is_admin ? 'admin' : 'user' // Convert is_admin to role\n        },\n        token: access_token,\n        isAuthenticated: true\n      });\n\n      // Set default Authorization header for all future requests\n      axios.defaults.headers.common['Authorization'] = `Bearer ${access_token}`;\n      return {\n        success: true\n      };\n    } catch (error) {\n      var _error$response, _error$response$data;\n      return {\n        success: false,\n        error: ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || 'Login failed'\n      };\n    }\n  },\n  register: async (email, password) => {\n    try {\n      await axios.post(`${API_URL}/auth/register`, {\n        email,\n        password\n      });\n\n      // Don't automatically log in after registration\n      return {\n        success: true,\n        message: 'Registration successful! Please log in to continue.'\n      };\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      return {\n        success: false,\n        error: ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.error) || 'Registration failed'\n      };\n    }\n  },\n  logout: () => {\n    localStorage.removeItem('token');\n    delete axios.defaults.headers.common['Authorization'];\n    set({\n      user: null,\n      token: null,\n      isAuthenticated: false\n    });\n  },\n  loadUser: async () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      return;\n    }\n    try {\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      const response = await axios.get(`${API_URL}/auth/me`);\n      set({\n        user: {\n          ...response.data,\n          role: response.data.is_admin ? 'admin' : 'user' // Convert is_admin to role\n        },\n        isAuthenticated: true,\n        token\n      });\n    } catch (error) {\n      localStorage.removeItem('token');\n      delete axios.defaults.headers.common['Authorization'];\n      set({\n        user: null,\n        token: null,\n        isAuthenticated: false\n      });\n    }\n  }\n}));","map":{"version":3,"names":["create","axios","API_URL","process","env","REACT_APP_API_URL","useAuthStore","set","user","isAuthenticated","token","localStorage","getItem","login","email","password","response","post","access_token","data","setItem","role","is_admin","defaults","headers","common","success","error","_error$response","_error$response$data","register","message","_error$response2","_error$response2$data","logout","removeItem","loadUser","get"],"sources":["C:/Users/akash/Desktop/MODEL/frontend/src/stores/authStore.js"],"sourcesContent":["import { create } from 'zustand';\r\nimport axios from 'axios';\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\r\n\r\nexport const useAuthStore = create((set) => ({\r\n  user: null,\r\n  isAuthenticated: false,\r\n  token: localStorage.getItem('token'),\r\n  \r\n  login: async (email, password) => {\r\n    try {\r\n      const response = await axios.post(`${API_URL}/auth/login`, {\r\n        email,\r\n        password\r\n      });\r\n      \r\n      const { access_token, user } = response.data;\r\n      \r\n      localStorage.setItem('token', access_token);\r\n      \r\n      set({\r\n        user: {\r\n          ...user,\r\n          role: user.is_admin ? 'admin' : 'user'  // Convert is_admin to role\r\n        },\r\n        token: access_token,\r\n        isAuthenticated: true\r\n      });\r\n      \r\n      // Set default Authorization header for all future requests\r\n      axios.defaults.headers.common['Authorization'] = `Bearer ${access_token}`;\r\n      \r\n      return { success: true };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        error: error.response?.data?.error || 'Login failed'\r\n      };\r\n    }\r\n  },\r\n  \r\n  register: async (email, password) => {\r\n    try {\r\n      await axios.post(`${API_URL}/auth/register`, {\r\n        email,\r\n        password\r\n      });\r\n      \r\n      // Don't automatically log in after registration\r\n      return { \r\n        success: true,\r\n        message: 'Registration successful! Please log in to continue.'\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        error: error.response?.data?.error || 'Registration failed'\r\n      };\r\n    }\r\n  },\r\n  \r\n  logout: () => {\r\n    localStorage.removeItem('token');\r\n    delete axios.defaults.headers.common['Authorization'];\r\n    \r\n    set({\r\n      user: null,\r\n      token: null,\r\n      isAuthenticated: false\r\n    });\r\n  },\r\n  \r\n  loadUser: async () => {\r\n    const token = localStorage.getItem('token');\r\n    \r\n    if (!token) {\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n      \r\n      const response = await axios.get(`${API_URL}/auth/me`);\r\n      \r\n      set({\r\n        user: {\r\n          ...response.data,\r\n          role: response.data.is_admin ? 'admin' : 'user'  // Convert is_admin to role\r\n        },\r\n        isAuthenticated: true,\r\n        token\r\n      });\r\n    } catch (error) {\r\n      localStorage.removeItem('token');\r\n      delete axios.defaults.headers.common['Authorization'];\r\n      \r\n      set({\r\n        user: null,\r\n        token: null,\r\n        isAuthenticated: false\r\n      });\r\n    }\r\n  }\r\n})); "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}