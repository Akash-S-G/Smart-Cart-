{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\akash\\\\Desktop\\\\MODEL\\\\SmartCart\\\\frontend\\\\src\\\\components\\\\CameraFeed.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport { io } from 'socket.io-client';\nimport { toast } from 'react-hot-toast';\nimport useCartStore from '../stores/cartStore';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_URL = process.env.REACT_APP_API_URL || 'http://192.168.74.207:5000';\nconst CameraFeed = ({\n  cartId\n}) => {\n  _s();\n  const [isConnected, setIsConnected] = useState(false);\n  const [lastDetection, setLastDetection] = useState(null);\n  const [lastAddedProduct, setLastAddedProduct] = useState({\n    id: null,\n    confidence: 0\n  });\n  const [useWebcam, setUseWebcam] = useState(false);\n  const socketRef = useRef(null);\n  const imageRef = useRef(null);\n  const videoRef = useRef(null);\n  const addItem = useCartStore(state => state.addItem);\n\n  // Webcam stream logic\n  useEffect(() => {\n    let stream;\n    if (useWebcam && videoRef.current) {\n      navigator.mediaDevices.getUserMedia({\n        video: true\n      }).then(s => {\n        stream = s;\n        videoRef.current.srcObject = stream;\n      }).catch(err => {\n        toast.error('Webcam access denied or not available');\n      });\n    }\n    return () => {\n      if (stream) {\n        stream.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, [useWebcam]);\n\n  // --- Webcam prediction logic ---\n  useEffect(() => {\n    if (!useWebcam) return;\n    let stopped = false;\n    // Store last 3 frame hashes\n    const lastFrameHashes = [];\n    // Simple average color hash function\n    function getFrameHash(ctx, width, height) {\n      const imgData = ctx.getImageData(0, 0, width, height).data;\n      let r = 0,\n        g = 0,\n        b = 0;\n      for (let i = 0; i < imgData.length; i += 4) {\n        r += imgData[i];\n        g += imgData[i + 1];\n        b += imgData[i + 2];\n      }\n      const n = imgData.length / 4;\n      return `${Math.round(r / n)}-${Math.round(g / n)}-${Math.round(b / n)}`;\n    }\n    // Use requestAnimationFrame for smoother polling\n    const processFrame = async () => {\n      if (stopped || !videoRef.current) return;\n      const video = videoRef.current;\n      if (video.readyState < 2) {\n        requestAnimationFrame(processFrame);\n        return;\n      }\n      const canvas = document.createElement('canvas');\n      canvas.width = video.videoWidth || 224;\n      canvas.height = video.videoHeight || 224;\n      const ctx = canvas.getContext('2d');\n      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n      const frameHash = getFrameHash(ctx, canvas.width, canvas.height);\n      if (lastFrameHashes.includes(frameHash)) {\n        requestAnimationFrame(processFrame);\n        return;\n      }\n      lastFrameHashes.push(frameHash);\n      if (lastFrameHashes.length > 3) lastFrameHashes.shift();\n      const dataUrl = canvas.toDataURL('image/jpeg');\n      const base64 = dataUrl.split(',')[1];\n      try {\n        // --- OpenAI API integration placeholder ---\n        // For security, call OpenAI API from backend, not frontend.\n        // Here, we just send to /predict_product as before.\n        const res = await fetch(`${API_URL}/predict_product`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            cart_id: cartId,\n            image_base64: base64,\n            use_openai: true\n          }) // pass flag to backend\n        });\n        const data = await res.json();\n        if (data && typeof data.confidence !== 'undefined' && data.product_name) {\n          setLastDetection(data);\n          if (data.product_name !== 'Unknown or Not Recognized' && typeof data.confidence === 'number' && data.confidence >= 0.85) {\n            if (lastAddedProduct.id !== data.product_id || lastAddedProduct.confidence < 0.85) {\n              const price = Math.floor(Math.random() * 100) + 1;\n              addItem({\n                id: data.product_id,\n                name: data.product_name,\n                price,\n                confidence: data.confidence\n              });\n              setLastAddedProduct({\n                id: data.product_id,\n                confidence: data.confidence\n              });\n              toast.success(`Added to cart: ${data.product_name} (₹${price})`);\n            }\n          } else {\n            if (lastAddedProduct.id === data.product_id && data.confidence < 0.85) {\n              setLastAddedProduct({\n                id: null,\n                confidence: 0\n              });\n            }\n          }\n        }\n      } catch (e) {\n        // ignore\n      }\n      requestAnimationFrame(processFrame);\n    };\n    requestAnimationFrame(processFrame);\n    return () => {\n      stopped = true;\n    };\n  }, [useWebcam, cartId, addItem, lastAddedProduct]);\n\n  // --- ESP32 polling logic ---\n  useEffect(() => {\n    if (useWebcam) return;\n    let lastImageUrl = null;\n    let lastConnected = false;\n    const fetchImage = () => {\n      fetch(`${API_URL}/latest_image?_t=${Date.now()}`).then(res => {\n        if (!res.ok) throw new Error('No image');\n        if (!lastConnected) {\n          setIsConnected(true);\n          lastConnected = true;\n        }\n        return res.blob();\n      }).then(blob => {\n        if (imageRef.current) {\n          if (lastImageUrl) URL.revokeObjectURL(lastImageUrl);\n          lastImageUrl = URL.createObjectURL(blob);\n          imageRef.current.src = lastImageUrl;\n        }\n      }).catch(() => {\n        if (imageRef.current) imageRef.current.src = '';\n        if (lastConnected) {\n          setIsConnected(false);\n          lastConnected = false;\n        }\n      });\n    };\n    fetchImage();\n    const interval = setInterval(fetchImage, 200);\n    return () => {\n      clearInterval(interval);\n      if (lastImageUrl) URL.revokeObjectURL(lastImageUrl);\n    };\n  }, [useWebcam]);\n  useEffect(() => {\n    if (useWebcam) return;\n    const fetchPrediction = () => {\n      fetch(`${API_URL}/latest_prediction`).then(res => res.json()).then(data => {\n        if (data && typeof data.confidence !== 'undefined' && data.product_name) {\n          setLastDetection(data);\n          if (data.product_name !== 'Unknown or Not Recognized' && typeof data.confidence === 'number' && data.confidence >= 0.85) {\n            if (lastAddedProduct.id !== data.product_id || lastAddedProduct.confidence < 0.85) {\n              const price = Math.floor(Math.random() * 100) + 1;\n              addItem({\n                id: data.product_id,\n                name: data.product_name,\n                price,\n                confidence: data.confidence\n              });\n              setLastAddedProduct({\n                id: data.product_id,\n                confidence: data.confidence\n              });\n              toast.success(`Added to cart: ${data.product_name} (₹${price})`);\n            }\n          } else {\n            if (lastAddedProduct.id === data.product_id && data.confidence < 0.85) {\n              setLastAddedProduct({\n                id: null,\n                confidence: 0\n              });\n            }\n          }\n        }\n      }).catch(() => {});\n    };\n    fetchPrediction();\n    const interval = setInterval(fetchPrediction, 1000);\n    return () => clearInterval(interval);\n  }, [cartId, addItem, lastAddedProduct, useWebcam]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white p-4 rounded-lg shadow\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-semibold mb-2\",\n        children: \"Camera Feed\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-2 mb-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: `w-3 h-3 rounded-full ${isConnected ? 'bg-green-500' : 'bg-red-500'}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm text-gray-600\",\n          children: isConnected ? 'Connected' : 'Disconnected'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: `px-3 py-1 rounded mr-2 ${!useWebcam ? 'bg-blue-500 text-white' : 'bg-gray-200'}`,\n          onClick: () => setUseWebcam(false),\n          children: \"ESP32 Camera\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `px-3 py-1 rounded ${useWebcam ? 'bg-blue-500 text-white' : 'bg-gray-200'}`,\n          onClick: () => setUseWebcam(true),\n          children: \"Webcam / Mobile Camera\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 7\n    }, this), lastDetection && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-3 bg-blue-50 rounded-lg \",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"font-medium mb-1\",\n        children: \"Last Prediction\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-sm text-gray-600\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Product: \", lastDetection.product_name || 'N/A']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Confidence: \", typeof lastDetection.confidence === 'number' && !isNaN(lastDetection.confidence) ? (lastDetection.confidence * 100).toFixed(1) + '%' : 'N/A']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative aspect-video mx-auto bg-gray-100 rounded-lg overflow-hidden mt-4 w-full max-w-2xl\",\n      children: [!useWebcam ? /*#__PURE__*/_jsxDEV(\"img\", {\n        ref: imageRef,\n        alt: \"Camera feed\",\n        className: \"w-full h-full object-cover\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        autoPlay: true,\n        playsInline: true,\n        className: \"w-full h-full object-cover\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 11\n      }, this), !isConnected && !useWebcam && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50 text-white\",\n        children: \"Connecting to camera...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 210,\n    columnNumber: 5\n  }, this);\n};\n_s(CameraFeed, \"BBxiGIBLcxkjmgR0o19dzR/Sfxs=\", false, function () {\n  return [useCartStore];\n});\n_c = CameraFeed;\nexport default CameraFeed;\nvar _c;\n$RefreshReg$(_c, \"CameraFeed\");","map":{"version":3,"names":["React","useEffect","useState","useRef","io","toast","useCartStore","jsxDEV","_jsxDEV","API_URL","process","env","REACT_APP_API_URL","CameraFeed","cartId","_s","isConnected","setIsConnected","lastDetection","setLastDetection","lastAddedProduct","setLastAddedProduct","id","confidence","useWebcam","setUseWebcam","socketRef","imageRef","videoRef","addItem","state","stream","current","navigator","mediaDevices","getUserMedia","video","then","s","srcObject","catch","err","error","getTracks","forEach","track","stop","stopped","lastFrameHashes","getFrameHash","ctx","width","height","imgData","getImageData","data","r","g","b","i","length","n","Math","round","processFrame","readyState","requestAnimationFrame","canvas","document","createElement","videoWidth","videoHeight","getContext","drawImage","frameHash","includes","push","shift","dataUrl","toDataURL","base64","split","res","fetch","method","headers","body","JSON","stringify","cart_id","image_base64","use_openai","json","product_name","product_id","price","floor","random","name","success","e","lastImageUrl","lastConnected","fetchImage","Date","now","ok","Error","blob","URL","revokeObjectURL","createObjectURL","src","interval","setInterval","clearInterval","fetchPrediction","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","isNaN","toFixed","ref","alt","autoPlay","playsInline","_c","$RefreshReg$"],"sources":["C:/Users/akash/Desktop/MODEL/SmartCart/frontend/src/components/CameraFeed.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { io } from 'socket.io-client';\nimport { toast } from 'react-hot-toast';\nimport useCartStore from '../stores/cartStore';\n\nconst API_URL = process.env.REACT_APP_API_URL || 'http://192.168.74.207:5000';\n\nconst CameraFeed = ({ cartId }) => {\n  const [isConnected, setIsConnected] = useState(false);\n  const [lastDetection, setLastDetection] = useState(null);\n  const [lastAddedProduct, setLastAddedProduct] = useState({ id: null, confidence: 0 });\n  const [useWebcam, setUseWebcam] = useState(false);\n  const socketRef = useRef(null);\n  const imageRef = useRef(null);\n  const videoRef = useRef(null);\n  const addItem = useCartStore(state => state.addItem);\n\n  // Webcam stream logic\n  useEffect(() => {\n    let stream;\n    if (useWebcam && videoRef.current) {\n      navigator.mediaDevices.getUserMedia({ video: true })\n        .then(s => {\n          stream = s;\n          videoRef.current.srcObject = stream;\n        })\n        .catch(err => {\n          toast.error('Webcam access denied or not available');\n        });\n    }\n    return () => {\n      if (stream) {\n        stream.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, [useWebcam]);\n\n  // --- Webcam prediction logic ---\n  useEffect(() => {\n    if (!useWebcam) return;\n    let stopped = false;\n    // Store last 3 frame hashes\n    const lastFrameHashes = [];\n    // Simple average color hash function\n    function getFrameHash(ctx, width, height) {\n      const imgData = ctx.getImageData(0, 0, width, height).data;\n      let r = 0, g = 0, b = 0;\n      for (let i = 0; i < imgData.length; i += 4) {\n        r += imgData[i];\n        g += imgData[i + 1];\n        b += imgData[i + 2];\n      }\n      const n = imgData.length / 4;\n      return `${Math.round(r / n)}-${Math.round(g / n)}-${Math.round(b / n)}`;\n    }\n    // Use requestAnimationFrame for smoother polling\n    const processFrame = async () => {\n      if (stopped || !videoRef.current) return;\n      const video = videoRef.current;\n      if (video.readyState < 2) {\n        requestAnimationFrame(processFrame);\n        return;\n      }\n      const canvas = document.createElement('canvas');\n      canvas.width = video.videoWidth || 224;\n      canvas.height = video.videoHeight || 224;\n      const ctx = canvas.getContext('2d');\n      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n      const frameHash = getFrameHash(ctx, canvas.width, canvas.height);\n      if (lastFrameHashes.includes(frameHash)) {\n        requestAnimationFrame(processFrame);\n        return;\n      }\n      lastFrameHashes.push(frameHash);\n      if (lastFrameHashes.length > 3) lastFrameHashes.shift();\n      const dataUrl = canvas.toDataURL('image/jpeg');\n      const base64 = dataUrl.split(',')[1];\n      try {\n        // --- OpenAI API integration placeholder ---\n        // For security, call OpenAI API from backend, not frontend.\n        // Here, we just send to /predict_product as before.\n        const res = await fetch(`${API_URL}/predict_product`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ cart_id: cartId, image_base64: base64, use_openai: true }) // pass flag to backend\n        });\n        const data = await res.json();\n        if (data && typeof data.confidence !== 'undefined' && data.product_name) {\n          setLastDetection(data);\n          if (\n            data.product_name !== 'Unknown or Not Recognized' &&\n            typeof data.confidence === 'number' &&\n            data.confidence >= 0.85\n          ) {\n            if (\n              lastAddedProduct.id !== data.product_id ||\n              lastAddedProduct.confidence < 0.85\n            ) {\n              const price = Math.floor(Math.random() * 100) + 1;\n              addItem({\n                id: data.product_id,\n                name: data.product_name,\n                price,\n                confidence: data.confidence\n              });\n              setLastAddedProduct({ id: data.product_id, confidence: data.confidence });\n              toast.success(`Added to cart: ${data.product_name} (₹${price})`);\n            }\n          } else {\n            if (\n              lastAddedProduct.id === data.product_id &&\n              data.confidence < 0.85\n            ) {\n              setLastAddedProduct({ id: null, confidence: 0 });\n            }\n          }\n        }\n      } catch (e) {\n        // ignore\n      }\n      requestAnimationFrame(processFrame);\n    };\n    requestAnimationFrame(processFrame);\n    return () => { stopped = true; };\n  }, [useWebcam, cartId, addItem, lastAddedProduct]);\n\n  // --- ESP32 polling logic ---\n  useEffect(() => {\n    if (useWebcam) return;\n    let lastImageUrl = null;\n    let lastConnected = false;\n    const fetchImage = () => {\n      fetch(`${API_URL}/latest_image?_t=${Date.now()}`)\n        .then(res => {\n          if (!res.ok) throw new Error('No image');\n          if (!lastConnected) {\n            setIsConnected(true);\n            lastConnected = true;\n          }\n          return res.blob();\n        })\n        .then(blob => {\n          if (imageRef.current) {\n            if (lastImageUrl) URL.revokeObjectURL(lastImageUrl);\n            lastImageUrl = URL.createObjectURL(blob);\n            imageRef.current.src = lastImageUrl;\n          }\n        })\n        .catch(() => {\n          if (imageRef.current) imageRef.current.src = '';\n          if (lastConnected) {\n            setIsConnected(false);\n            lastConnected = false;\n          }\n        });\n    };\n    fetchImage();\n    const interval = setInterval(fetchImage, 200);\n    return () => {\n      clearInterval(interval);\n      if (lastImageUrl) URL.revokeObjectURL(lastImageUrl);\n    };\n  }, [useWebcam]);\n\n  useEffect(() => {\n    if (useWebcam) return;\n    const fetchPrediction = () => {\n      fetch(`${API_URL}/latest_prediction`)\n        .then(res => res.json())\n        .then(data => {\n          if (data && typeof data.confidence !== 'undefined' && data.product_name) {\n            setLastDetection(data);\n            if (\n              data.product_name !== 'Unknown or Not Recognized' &&\n              typeof data.confidence === 'number' &&\n              data.confidence >= 0.85\n            ) {\n              if (\n                lastAddedProduct.id !== data.product_id ||\n                lastAddedProduct.confidence < 0.85\n              ) {\n                const price = Math.floor(Math.random() * 100) + 1;\n                addItem({\n                  id: data.product_id,\n                  name: data.product_name,\n                  price,\n                  confidence: data.confidence\n                });\n                setLastAddedProduct({ id: data.product_id, confidence: data.confidence });\n                toast.success(`Added to cart: ${data.product_name} (₹${price})`);\n              }\n            } else {\n              if (\n                lastAddedProduct.id === data.product_id &&\n                data.confidence < 0.85\n              ) {\n                setLastAddedProduct({ id: null, confidence: 0 });\n              }\n            }\n          }\n        })\n        .catch(() => {});\n    };\n    fetchPrediction();\n    const interval = setInterval(fetchPrediction, 1000);\n    return () => clearInterval(interval);\n  }, [cartId, addItem, lastAddedProduct, useWebcam]);\n\n  return (\n    <div className=\"bg-white p-4 rounded-lg shadow\">\n      <div className=\"mb-4\">\n        <h2 className=\"text-xl font-semibold mb-2\">Camera Feed</h2>\n        <div className=\"flex items-center space-x-2 mb-2\">\n          <div\n            className={`w-3 h-3 rounded-full ${isConnected ? 'bg-green-500' : 'bg-red-500'}`}\n          />\n          <span className=\"text-sm text-gray-600\">\n            {isConnected ? 'Connected' : 'Disconnected'}\n          </span>\n        </div>\n        <div className=\"mb-2\">\n          <button\n            className={`px-3 py-1 rounded mr-2 ${!useWebcam ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}\n            onClick={() => setUseWebcam(false)}\n          >\n            ESP32 Camera\n          </button>\n          <button\n            className={`px-3 py-1 rounded ${useWebcam ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}\n            onClick={() => setUseWebcam(true)}\n          >\n            Webcam / Mobile Camera\n          </button>\n        </div>\n      </div>\n      {lastDetection && (\n        <div className=\"p-3 bg-blue-50 rounded-lg \">\n          <h3 className=\"font-medium mb-1\">Last Prediction</h3>\n          <div className=\"text-sm text-gray-600\">\n            <p>Product: {lastDetection.product_name || 'N/A'}</p>\n            <p>\n              Confidence: {typeof lastDetection.confidence === 'number' && !isNaN(lastDetection.confidence)\n                ? (lastDetection.confidence * 100).toFixed(1) + '%'\n                : 'N/A'}\n            </p>\n          </div>\n        </div>\n      )}\n      <div className=\"relative aspect-video mx-auto bg-gray-100 rounded-lg overflow-hidden mt-4 w-full max-w-2xl\">\n        {!useWebcam ? (\n          <img\n            ref={imageRef}\n            alt=\"Camera feed\"\n            className=\"w-full h-full object-cover\"\n          />\n        ) : (\n          <video\n            ref={videoRef}\n            autoPlay\n            playsInline\n            className=\"w-full h-full object-cover\"\n          />\n        )}\n        {!isConnected && !useWebcam && (\n          <div className=\"absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50 text-white\">\n            Connecting to camera...\n          </div>\n        )}\n      </div>\n\n      \n    </div>\n  );\n};\n\nexport default CameraFeed;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,EAAEC,MAAM,QAAQ,OAAO;AAC1D,SAASC,EAAE,QAAQ,kBAAkB;AACrC,SAASC,KAAK,QAAQ,iBAAiB;AACvC,OAAOC,YAAY,MAAM,qBAAqB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE/C,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,IAAI,4BAA4B;AAE7E,MAAMC,UAAU,GAAGA,CAAC;EAAEC;AAAO,CAAC,KAAK;EAAAC,EAAA;EACjC,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGf,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACgB,aAAa,EAAEC,gBAAgB,CAAC,GAAGjB,QAAQ,CAAC,IAAI,CAAC;EACxD,MAAM,CAACkB,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGnB,QAAQ,CAAC;IAAEoB,EAAE,EAAE,IAAI;IAAEC,UAAU,EAAE;EAAE,CAAC,CAAC;EACrF,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGvB,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAMwB,SAAS,GAAGvB,MAAM,CAAC,IAAI,CAAC;EAC9B,MAAMwB,QAAQ,GAAGxB,MAAM,CAAC,IAAI,CAAC;EAC7B,MAAMyB,QAAQ,GAAGzB,MAAM,CAAC,IAAI,CAAC;EAC7B,MAAM0B,OAAO,GAAGvB,YAAY,CAACwB,KAAK,IAAIA,KAAK,CAACD,OAAO,CAAC;;EAEpD;EACA5B,SAAS,CAAC,MAAM;IACd,IAAI8B,MAAM;IACV,IAAIP,SAAS,IAAII,QAAQ,CAACI,OAAO,EAAE;MACjCC,SAAS,CAACC,YAAY,CAACC,YAAY,CAAC;QAAEC,KAAK,EAAE;MAAK,CAAC,CAAC,CACjDC,IAAI,CAACC,CAAC,IAAI;QACTP,MAAM,GAAGO,CAAC;QACVV,QAAQ,CAACI,OAAO,CAACO,SAAS,GAAGR,MAAM;MACrC,CAAC,CAAC,CACDS,KAAK,CAACC,GAAG,IAAI;QACZpC,KAAK,CAACqC,KAAK,CAAC,uCAAuC,CAAC;MACtD,CAAC,CAAC;IACN;IACA,OAAO,MAAM;MACX,IAAIX,MAAM,EAAE;QACVA,MAAM,CAACY,SAAS,CAAC,CAAC,CAACC,OAAO,CAACC,KAAK,IAAIA,KAAK,CAACC,IAAI,CAAC,CAAC,CAAC;MACnD;IACF,CAAC;EACH,CAAC,EAAE,CAACtB,SAAS,CAAC,CAAC;;EAEf;EACAvB,SAAS,CAAC,MAAM;IACd,IAAI,CAACuB,SAAS,EAAE;IAChB,IAAIuB,OAAO,GAAG,KAAK;IACnB;IACA,MAAMC,eAAe,GAAG,EAAE;IAC1B;IACA,SAASC,YAAYA,CAACC,GAAG,EAAEC,KAAK,EAAEC,MAAM,EAAE;MACxC,MAAMC,OAAO,GAAGH,GAAG,CAACI,YAAY,CAAC,CAAC,EAAE,CAAC,EAAEH,KAAK,EAAEC,MAAM,CAAC,CAACG,IAAI;MAC1D,IAAIC,CAAC,GAAG,CAAC;QAAEC,CAAC,GAAG,CAAC;QAAEC,CAAC,GAAG,CAAC;MACvB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGN,OAAO,CAACO,MAAM,EAAED,CAAC,IAAI,CAAC,EAAE;QAC1CH,CAAC,IAAIH,OAAO,CAACM,CAAC,CAAC;QACfF,CAAC,IAAIJ,OAAO,CAACM,CAAC,GAAG,CAAC,CAAC;QACnBD,CAAC,IAAIL,OAAO,CAACM,CAAC,GAAG,CAAC,CAAC;MACrB;MACA,MAAME,CAAC,GAAGR,OAAO,CAACO,MAAM,GAAG,CAAC;MAC5B,OAAO,GAAGE,IAAI,CAACC,KAAK,CAACP,CAAC,GAAGK,CAAC,CAAC,IAAIC,IAAI,CAACC,KAAK,CAACN,CAAC,GAAGI,CAAC,CAAC,IAAIC,IAAI,CAACC,KAAK,CAACL,CAAC,GAAGG,CAAC,CAAC,EAAE;IACzE;IACA;IACA,MAAMG,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/B,IAAIjB,OAAO,IAAI,CAACnB,QAAQ,CAACI,OAAO,EAAE;MAClC,MAAMI,KAAK,GAAGR,QAAQ,CAACI,OAAO;MAC9B,IAAII,KAAK,CAAC6B,UAAU,GAAG,CAAC,EAAE;QACxBC,qBAAqB,CAACF,YAAY,CAAC;QACnC;MACF;MACA,MAAMG,MAAM,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;MAC/CF,MAAM,CAAChB,KAAK,GAAGf,KAAK,CAACkC,UAAU,IAAI,GAAG;MACtCH,MAAM,CAACf,MAAM,GAAGhB,KAAK,CAACmC,WAAW,IAAI,GAAG;MACxC,MAAMrB,GAAG,GAAGiB,MAAM,CAACK,UAAU,CAAC,IAAI,CAAC;MACnCtB,GAAG,CAACuB,SAAS,CAACrC,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE+B,MAAM,CAAChB,KAAK,EAAEgB,MAAM,CAACf,MAAM,CAAC;MACvD,MAAMsB,SAAS,GAAGzB,YAAY,CAACC,GAAG,EAAEiB,MAAM,CAAChB,KAAK,EAAEgB,MAAM,CAACf,MAAM,CAAC;MAChE,IAAIJ,eAAe,CAAC2B,QAAQ,CAACD,SAAS,CAAC,EAAE;QACvCR,qBAAqB,CAACF,YAAY,CAAC;QACnC;MACF;MACAhB,eAAe,CAAC4B,IAAI,CAACF,SAAS,CAAC;MAC/B,IAAI1B,eAAe,CAACY,MAAM,GAAG,CAAC,EAAEZ,eAAe,CAAC6B,KAAK,CAAC,CAAC;MACvD,MAAMC,OAAO,GAAGX,MAAM,CAACY,SAAS,CAAC,YAAY,CAAC;MAC9C,MAAMC,MAAM,GAAGF,OAAO,CAACG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;MACpC,IAAI;QACF;QACA;QACA;QACA,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAG1E,OAAO,kBAAkB,EAAE;UACpD2E,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YAAE,cAAc,EAAE;UAAmB,CAAC;UAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;YAAEC,OAAO,EAAE3E,MAAM;YAAE4E,YAAY,EAAEV,MAAM;YAAEW,UAAU,EAAE;UAAK,CAAC,CAAC,CAAC;QACpF,CAAC,CAAC;QACF,MAAMpC,IAAI,GAAG,MAAM2B,GAAG,CAACU,IAAI,CAAC,CAAC;QAC7B,IAAIrC,IAAI,IAAI,OAAOA,IAAI,CAAChC,UAAU,KAAK,WAAW,IAAIgC,IAAI,CAACsC,YAAY,EAAE;UACvE1E,gBAAgB,CAACoC,IAAI,CAAC;UACtB,IACEA,IAAI,CAACsC,YAAY,KAAK,2BAA2B,IACjD,OAAOtC,IAAI,CAAChC,UAAU,KAAK,QAAQ,IACnCgC,IAAI,CAAChC,UAAU,IAAI,IAAI,EACvB;YACA,IACEH,gBAAgB,CAACE,EAAE,KAAKiC,IAAI,CAACuC,UAAU,IACvC1E,gBAAgB,CAACG,UAAU,GAAG,IAAI,EAClC;cACA,MAAMwE,KAAK,GAAGjC,IAAI,CAACkC,KAAK,CAAClC,IAAI,CAACmC,MAAM,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC;cACjDpE,OAAO,CAAC;gBACNP,EAAE,EAAEiC,IAAI,CAACuC,UAAU;gBACnBI,IAAI,EAAE3C,IAAI,CAACsC,YAAY;gBACvBE,KAAK;gBACLxE,UAAU,EAAEgC,IAAI,CAAChC;cACnB,CAAC,CAAC;cACFF,mBAAmB,CAAC;gBAAEC,EAAE,EAAEiC,IAAI,CAACuC,UAAU;gBAAEvE,UAAU,EAAEgC,IAAI,CAAChC;cAAW,CAAC,CAAC;cACzElB,KAAK,CAAC8F,OAAO,CAAC,kBAAkB5C,IAAI,CAACsC,YAAY,MAAME,KAAK,GAAG,CAAC;YAClE;UACF,CAAC,MAAM;YACL,IACE3E,gBAAgB,CAACE,EAAE,KAAKiC,IAAI,CAACuC,UAAU,IACvCvC,IAAI,CAAChC,UAAU,GAAG,IAAI,EACtB;cACAF,mBAAmB,CAAC;gBAAEC,EAAE,EAAE,IAAI;gBAAEC,UAAU,EAAE;cAAE,CAAC,CAAC;YAClD;UACF;QACF;MACF,CAAC,CAAC,OAAO6E,CAAC,EAAE;QACV;MAAA;MAEFlC,qBAAqB,CAACF,YAAY,CAAC;IACrC,CAAC;IACDE,qBAAqB,CAACF,YAAY,CAAC;IACnC,OAAO,MAAM;MAAEjB,OAAO,GAAG,IAAI;IAAE,CAAC;EAClC,CAAC,EAAE,CAACvB,SAAS,EAAEV,MAAM,EAAEe,OAAO,EAAET,gBAAgB,CAAC,CAAC;;EAElD;EACAnB,SAAS,CAAC,MAAM;IACd,IAAIuB,SAAS,EAAE;IACf,IAAI6E,YAAY,GAAG,IAAI;IACvB,IAAIC,aAAa,GAAG,KAAK;IACzB,MAAMC,UAAU,GAAGA,CAAA,KAAM;MACvBpB,KAAK,CAAC,GAAG1E,OAAO,oBAAoB+F,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE,CAAC,CAC9CpE,IAAI,CAAC6C,GAAG,IAAI;QACX,IAAI,CAACA,GAAG,CAACwB,EAAE,EAAE,MAAM,IAAIC,KAAK,CAAC,UAAU,CAAC;QACxC,IAAI,CAACL,aAAa,EAAE;UAClBrF,cAAc,CAAC,IAAI,CAAC;UACpBqF,aAAa,GAAG,IAAI;QACtB;QACA,OAAOpB,GAAG,CAAC0B,IAAI,CAAC,CAAC;MACnB,CAAC,CAAC,CACDvE,IAAI,CAACuE,IAAI,IAAI;QACZ,IAAIjF,QAAQ,CAACK,OAAO,EAAE;UACpB,IAAIqE,YAAY,EAAEQ,GAAG,CAACC,eAAe,CAACT,YAAY,CAAC;UACnDA,YAAY,GAAGQ,GAAG,CAACE,eAAe,CAACH,IAAI,CAAC;UACxCjF,QAAQ,CAACK,OAAO,CAACgF,GAAG,GAAGX,YAAY;QACrC;MACF,CAAC,CAAC,CACD7D,KAAK,CAAC,MAAM;QACX,IAAIb,QAAQ,CAACK,OAAO,EAAEL,QAAQ,CAACK,OAAO,CAACgF,GAAG,GAAG,EAAE;QAC/C,IAAIV,aAAa,EAAE;UACjBrF,cAAc,CAAC,KAAK,CAAC;UACrBqF,aAAa,GAAG,KAAK;QACvB;MACF,CAAC,CAAC;IACN,CAAC;IACDC,UAAU,CAAC,CAAC;IACZ,MAAMU,QAAQ,GAAGC,WAAW,CAACX,UAAU,EAAE,GAAG,CAAC;IAC7C,OAAO,MAAM;MACXY,aAAa,CAACF,QAAQ,CAAC;MACvB,IAAIZ,YAAY,EAAEQ,GAAG,CAACC,eAAe,CAACT,YAAY,CAAC;IACrD,CAAC;EACH,CAAC,EAAE,CAAC7E,SAAS,CAAC,CAAC;EAEfvB,SAAS,CAAC,MAAM;IACd,IAAIuB,SAAS,EAAE;IACf,MAAM4F,eAAe,GAAGA,CAAA,KAAM;MAC5BjC,KAAK,CAAC,GAAG1E,OAAO,oBAAoB,CAAC,CAClC4B,IAAI,CAAC6C,GAAG,IAAIA,GAAG,CAACU,IAAI,CAAC,CAAC,CAAC,CACvBvD,IAAI,CAACkB,IAAI,IAAI;QACZ,IAAIA,IAAI,IAAI,OAAOA,IAAI,CAAChC,UAAU,KAAK,WAAW,IAAIgC,IAAI,CAACsC,YAAY,EAAE;UACvE1E,gBAAgB,CAACoC,IAAI,CAAC;UACtB,IACEA,IAAI,CAACsC,YAAY,KAAK,2BAA2B,IACjD,OAAOtC,IAAI,CAAChC,UAAU,KAAK,QAAQ,IACnCgC,IAAI,CAAChC,UAAU,IAAI,IAAI,EACvB;YACA,IACEH,gBAAgB,CAACE,EAAE,KAAKiC,IAAI,CAACuC,UAAU,IACvC1E,gBAAgB,CAACG,UAAU,GAAG,IAAI,EAClC;cACA,MAAMwE,KAAK,GAAGjC,IAAI,CAACkC,KAAK,CAAClC,IAAI,CAACmC,MAAM,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC;cACjDpE,OAAO,CAAC;gBACNP,EAAE,EAAEiC,IAAI,CAACuC,UAAU;gBACnBI,IAAI,EAAE3C,IAAI,CAACsC,YAAY;gBACvBE,KAAK;gBACLxE,UAAU,EAAEgC,IAAI,CAAChC;cACnB,CAAC,CAAC;cACFF,mBAAmB,CAAC;gBAAEC,EAAE,EAAEiC,IAAI,CAACuC,UAAU;gBAAEvE,UAAU,EAAEgC,IAAI,CAAChC;cAAW,CAAC,CAAC;cACzElB,KAAK,CAAC8F,OAAO,CAAC,kBAAkB5C,IAAI,CAACsC,YAAY,MAAME,KAAK,GAAG,CAAC;YAClE;UACF,CAAC,MAAM;YACL,IACE3E,gBAAgB,CAACE,EAAE,KAAKiC,IAAI,CAACuC,UAAU,IACvCvC,IAAI,CAAChC,UAAU,GAAG,IAAI,EACtB;cACAF,mBAAmB,CAAC;gBAAEC,EAAE,EAAE,IAAI;gBAAEC,UAAU,EAAE;cAAE,CAAC,CAAC;YAClD;UACF;QACF;MACF,CAAC,CAAC,CACDiB,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;IACpB,CAAC;IACD4E,eAAe,CAAC,CAAC;IACjB,MAAMH,QAAQ,GAAGC,WAAW,CAACE,eAAe,EAAE,IAAI,CAAC;IACnD,OAAO,MAAMD,aAAa,CAACF,QAAQ,CAAC;EACtC,CAAC,EAAE,CAACnG,MAAM,EAAEe,OAAO,EAAET,gBAAgB,EAAEI,SAAS,CAAC,CAAC;EAElD,oBACEhB,OAAA;IAAK6G,SAAS,EAAC,gCAAgC;IAAAC,QAAA,gBAC7C9G,OAAA;MAAK6G,SAAS,EAAC,MAAM;MAAAC,QAAA,gBACnB9G,OAAA;QAAI6G,SAAS,EAAC,4BAA4B;QAAAC,QAAA,EAAC;MAAW;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC3DlH,OAAA;QAAK6G,SAAS,EAAC,kCAAkC;QAAAC,QAAA,gBAC/C9G,OAAA;UACE6G,SAAS,EAAE,wBAAwBrG,WAAW,GAAG,cAAc,GAAG,YAAY;QAAG;UAAAuG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAClF,CAAC,eACFlH,OAAA;UAAM6G,SAAS,EAAC,uBAAuB;UAAAC,QAAA,EACpCtG,WAAW,GAAG,WAAW,GAAG;QAAc;UAAAuG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACJ,CAAC,eACNlH,OAAA;QAAK6G,SAAS,EAAC,MAAM;QAAAC,QAAA,gBACnB9G,OAAA;UACE6G,SAAS,EAAE,0BAA0B,CAAC7F,SAAS,GAAG,wBAAwB,GAAG,aAAa,EAAG;UAC7FmG,OAAO,EAAEA,CAAA,KAAMlG,YAAY,CAAC,KAAK,CAAE;UAAA6F,QAAA,EACpC;QAED;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACTlH,OAAA;UACE6G,SAAS,EAAE,qBAAqB7F,SAAS,GAAG,wBAAwB,GAAG,aAAa,EAAG;UACvFmG,OAAO,EAAEA,CAAA,KAAMlG,YAAY,CAAC,IAAI,CAAE;UAAA6F,QAAA,EACnC;QAED;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,EACLxG,aAAa,iBACZV,OAAA;MAAK6G,SAAS,EAAC,4BAA4B;MAAAC,QAAA,gBACzC9G,OAAA;QAAI6G,SAAS,EAAC,kBAAkB;QAAAC,QAAA,EAAC;MAAe;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACrDlH,OAAA;QAAK6G,SAAS,EAAC,uBAAuB;QAAAC,QAAA,gBACpC9G,OAAA;UAAA8G,QAAA,GAAG,WAAS,EAACpG,aAAa,CAAC2E,YAAY,IAAI,KAAK;QAAA;UAAA0B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACrDlH,OAAA;UAAA8G,QAAA,GAAG,cACW,EAAC,OAAOpG,aAAa,CAACK,UAAU,KAAK,QAAQ,IAAI,CAACqG,KAAK,CAAC1G,aAAa,CAACK,UAAU,CAAC,GACzF,CAACL,aAAa,CAACK,UAAU,GAAG,GAAG,EAAEsG,OAAO,CAAC,CAAC,CAAC,GAAG,GAAG,GACjD,KAAK;QAAA;UAAAN,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACR,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,eACDlH,OAAA;MAAK6G,SAAS,EAAC,4FAA4F;MAAAC,QAAA,GACxG,CAAC9F,SAAS,gBACThB,OAAA;QACEsH,GAAG,EAAEnG,QAAS;QACdoG,GAAG,EAAC,aAAa;QACjBV,SAAS,EAAC;MAA4B;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvC,CAAC,gBAEFlH,OAAA;QACEsH,GAAG,EAAElG,QAAS;QACdoG,QAAQ;QACRC,WAAW;QACXZ,SAAS,EAAC;MAA4B;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvC,CACF,EACA,CAAC1G,WAAW,IAAI,CAACQ,SAAS,iBACzBhB,OAAA;QAAK6G,SAAS,EAAC,wFAAwF;QAAAC,QAAA,EAAC;MAExG;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAGH,CAAC;AAEV,CAAC;AAAC3G,EAAA,CA1QIF,UAAU;EAAA,QAQEP,YAAY;AAAA;AAAA4H,EAAA,GARxBrH,UAAU;AA4QhB,eAAeA,UAAU;AAAC,IAAAqH,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}